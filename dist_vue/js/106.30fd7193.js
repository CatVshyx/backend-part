"use strict";(self["webpackChunkcms_yurka"]=self["webpackChunkcms_yurka"]||[]).push([[106],{3513:function(e,t){t.Z={firstUp(e){return e.substring(0,1).toUpperCase()+e.substring(1)},sleep(e){return new Promise((t=>{setTimeout(t,e)}))},randomName(e=Math.round(6+10*Math.random())){const t="abcdefghijklmnopaeouiqrstuvwxyz";let o="";for(let s=0;s<e;++s)o+=t.charAt(Math.floor(Math.random()*t.length)),0==s&&(o=o.toUpperCase());return o},randomPassword(e){e||(e=10+10*Math.random()|0);const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let o="";for(let s=0;s<e;s++)o+=t[Math.random()*t.length|0];return o},fullLocale(e){switch(e.toLowerCase()){case"ua":return"uk-UA";case"ru":return"ru-RU";default:return"en-US"}},localization(e,t,o,s){if(!e)return s;if(e%100>=10&&e%100<=20)return s;switch(e%10){case 1:return t;case 2:case 3:case 4:return o;default:return s}}}},7648:function(e,t,o){o.d(t,{Z:function(){return A}});var s=o(3396),i=o(7139),r=o(9242);const a=e=>((0,s.dD)("data-v-44f42a5e"),e=e(),(0,s.Cn)(),e),n={class:"filter-bar-container"},l=a((()=>(0,s._)("i",{class:"fa-regular fa-arrow-down-triangle-square"},null,-1))),c=[l],d={class:"head-top"},m={class:"title"},u={style:{"font-size":"22px"}},p={key:0,class:"buttons"},f=a((()=>(0,s._)("i",{class:"fa-solid fa-plus"},null,-1))),h=a((()=>(0,s._)("p",null,"Додати",-1))),g=[f,h];function k(e,t,o,a,l,f){const h=(0,s.up)("HeadbarPlus"),k=(0,s.up)("MinSearchBar");return(0,s.wg)(),(0,s.iD)(s.HY,null,[e.canAdd?((0,s.wg)(),(0,s.j4)(h,{key:0,onClick:t[0]||(t[0]=t=>e.$emit("clickAdd"))})):(0,s.kq)("",!0),(0,s._)("div",n,[(0,s._)("div",{class:(0,i.C_)(["filter-bar",{right:!e.canAdd}])},[e.sortable?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"sort",onClick:t[1]||(t[1]=(0,r.iM)((t=>e.$emit("openSorting")),["stop"]))},c)):(0,s.kq)("",!0),(0,s.Wm)(k,{class:"search-bar",onInput:e.setFilter},null,8,["onInput"]),(0,s.WI)(e.$slots,"default",{},void 0,!0)],2)]),(0,s._)("div",d,[(0,s._)("div",m,[(0,s._)("h2",u,(0,i.zw)(e.title),1)]),e.canAdd?((0,s.wg)(),(0,s.iD)("div",p,[(0,s._)("button",{class:"button add",onClick:t[2]||(t[2]=t=>e.$emit("clickAdd"))},g)])):(0,s.kq)("",!0)])],64)}var w=o(7106);const v=e=>((0,s.dD)("data-v-583e7645"),e=e(),(0,s.Cn)(),e),y=v((()=>(0,s._)("i",{class:"fa-solid fa-plus"},null,-1))),b=[y];function _(e,t,o,i,r,a){return(0,s.wg)(),(0,s.j4)(s.lR,{to:"#mobile-headbar"},[(0,s._)("button",{class:"headbar-plus",onClick:t[0]||(t[0]=t=>e.$emit("click",t))},b)])}var C=(0,s.aZ)({name:"HeadbarPlus",setup:()=>({}),data:()=>({}),mounted(){},computed:{},methods:{},emits:{click:e=>!0}}),D=o(89);const F=(0,D.Z)(C,[["render",_],["__scopeId","data-v-583e7645"]]);var Z=F,L=(0,s.aZ)({name:"PageHead",components:{MinSearchBar:w.Z,HeadbarPlus:Z},props:{title:{type:String,required:!0},canAdd:{type:Boolean,default:!0},sortable:Boolean},setup:()=>({}),computed:{},methods:{openSorting(){},setFilter(e){this.$emit("setFilter",e.target.value.toLowerCase())}},emits:{clickAdd:()=>!0,setFilter:e=>!0,openSorting:()=>!0}});const M=(0,D.Z)(L,[["render",k],["__scopeId","data-v-44f42a5e"]]);var A=M},5106:function(e,t,o){o.r(t),o.d(t,{default:function(){return ze}});var s=o(3396),i=o(7139);const r=e=>((0,s.dD)("data-v-59691208"),e=e(),(0,s.Cn)(),e),a={key:0,class:"documents-page"},n={class:"description"},l={class:"documents"},c=["onClick"],d={key:0,class:"fa-light fa-file"},m={key:1,class:"fa-light fa-ballot-check"},u={key:2,class:"fa-light fa-address-book"},p={class:"info"},f=["onClick"],h=r((()=>(0,s._)("i",{class:"fa-regular fa-ellipsis-vertical"},null,-1))),g=[h];function k(e,t,o,r,h,k){const w=(0,s.up)("PageHead"),v=(0,s.up)("CreateFormModal"),y=(0,s.up)("EditFormModal"),b=(0,s.up)("FormActions"),_=(0,s.up)("FormViewModal");return e.category?((0,s.wg)(),(0,s.iD)("div",a,[(0,s.Wm)(w,{title:e.categoryName,"can-add":e.session.me?.admin,onSetFilter:t[0]||(t[0]=t=>e.filter=t),onClickAdd:t[1]||(t[1]=t=>e.openModal("create-form-modal"))},null,8,["title","can-add"]),(0,s._)("p",n,(0,i.zw)(e.category.description),1),(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.filteredForms,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"document component",key:t.id},[(0,s._)("div",{class:"icon",onClick:o=>e.openModal("view-form-modal",t)},[t.blankLink||t.sampleLink?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("i",d)),t.blankLink?((0,s.wg)(),(0,s.iD)("i",m)):(0,s.kq)("",!0),t.sampleLink?((0,s.wg)(),(0,s.iD)("i",u)):(0,s.kq)("",!0)],8,c),(0,s._)("div",p,[(0,s._)("p",null,(0,i.zw)(t.name),1),(0,s._)("button",{class:"more",onClick:o=>e.openFormActions(t,o)},g,8,f)])])))),128))]),(0,s.Wm)(v,{ref:"create-form-modal","first-category":e.category,onReloadDocuments:t[2]||(t[2]=t=>e.loadDocumentsForm(e.category))},null,8,["first-category"]),(0,s.Wm)(y,{ref:"edit-form-modal",onReloadDocuments:t[3]||(t[3]=t=>e.loadDocumentsForm(e.category))},null,512),(0,s.Wm)(b,{options:e.formActions,onReload:t[4]||(t[4]=t=>e.loadDocumentsForm(e.category)),onEdit:t[5]||(t[5]=t=>e.openModal("edit-form-modal",t)),onView:t[6]||(t[6]=t=>e.openModal("view-form-modal",t))},null,8,["options"]),(0,s.Wm)(_,{ref:"view-form-modal"},null,512)])):(0,s.kq)("",!0)}var w=o(9720),v=o(1380),y=o(7648),b=o(4074),_=o(727);const C=e=>((0,s.dD)("data-v-1930165a"),e=e(),(0,s.Cn)(),e),D={class:"input-block"},F=C((()=>(0,s._)("label",{for:"name"},"Назва:",-1))),Z={class:"error-label"},L={class:"upload-files"},M={class:"input-block category-block"},A=C((()=>(0,s._)("p",{class:"label"},"Категорії:",-1))),x={class:"categories"},B=["onClick"],O=C((()=>(0,s._)("i",{class:"fa-solid fa-plus"},null,-1))),q=[O],$={key:1},S=["onClick"],I={class:"error-label"};function z(e,t,o,r,a,n){const l=(0,s.up)("FileUploader"),c=(0,s.up)("ListMenu"),d=(0,s.up)("Modal");return e.isOpenedModal?((0,s.wg)(),(0,s.j4)(d,{key:0,props:e.$props,ref:"modal"},{default:(0,s.w5)((()=>[(0,s._)("div",D,[F,(0,s._)("input",{type:"text",name:"name",id:"name",onInput:t[0]||(t[0]=t=>e.errors.name="")},null,32)]),(0,s._)("p",Z,(0,i.zw)(e.errors.name),1),(0,s._)("div",L,[(0,s.Wm)(l,{ref:"blank",label:"Додати бланк"},null,512),(0,s.Wm)(l,{ref:"sample",label:"Додати зразок"},null,512)]),(0,s._)("div",M,[A,(0,s._)("div",x,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.categories,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"category",key:t.id},[(0,s._)("div",{class:"close",onClick:o=>e.removeCategory(t)},null,8,B),(0,s._)("p",null,(0,i.zw)(t.name),1)])))),128)),e.categoriesLeft?.length?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"add",onClick:t[1]||(t[1]=(...t)=>e.openAdder&&e.openAdder(...t))},q)):(0,s.kq)("",!0),e.categoriesLeft?.length?((0,s.wg)(),(0,s.iD)("div",$,[(0,s.Wm)(c,{"is-open":e.isAdderOpen,"marker-top":"-5px","marker-left":"15px","marker-rotate":"-135deg",class:"category-adder"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.categoriesLeft,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id,onClick:o=>e.addCategory(t)},[(0,s._)("p",null,(0,i.zw)(t.name),1)],8,S)))),128))])),_:1},8,["is-open"])])):(0,s.kq)("",!0)])]),(0,s._)("p",I,(0,i.zw)(e.errors.categories),1)])),_:1},8,["props"])):(0,s.kq)("",!0)}o(7658);var T=o(9197),j=o(2492),H=o.n(j);const R={class:"text"};function W(e,t,o,r,a,n){return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["file-uploader",{"in-drag":e.inDrag}])},[(0,s._)("i",{class:(0,i.C_)(["fa-light",[{"fa-bounce":e.inDrag},e.icon||"fa-file-arrow-up"]])},null,2),(0,s._)("p",R,(0,i.zw)(e.name||e.label),1),(0,s._)("input",{type:"file",class:"file-input",ref:"input",onDragenter:t[0]||(t[0]=(...t)=>e.dragenter&&e.dragenter(...t)),onDragend:t[1]||(t[1]=(...t)=>e.dragend&&e.dragend(...t)),onDragleave:t[2]||(t[2]=(...t)=>e.dragleave&&e.dragleave(...t)),onChange:t[3]||(t[3]=(...t)=>e.change&&e.change(...t))},null,544)],2)}var U=(0,s.aZ)({name:"FileUploader",setup:()=>({}),props:{label:{type:String,default:"Upload file"},icon:String},data:()=>({inDrag:!1,name:""}),mounted(){},computed:{},methods:{dragenter(){this.inDrag=!0},dragleave(){this.inDrag=!1},dragend(){this.inDrag=!1},change(e){this.inDrag=!1;const t=e.target,o=t?.files?.[0];if(!o)return this.name="";this.name=o.name,console.log(o)}},emits:{}}),P=o(89);const E=(0,P.Z)(U,[["render",W],["__scopeId","data-v-2bbf81e0"]]);var N=E,Y=o(1969),K=o(5222),V=(0,s.aZ)({name:"CreateFormModal",components:{Modal:T.Z,FileUploader:N,ListMenu:Y.Z},mixins:[_.O],props:{...T.w,firstCategory:{type:Object,required:!0}},setup:()=>({store:(0,w.Z)()}),data:()=>({errors:{name:"",categories:""},categories:[],isAdderOpen:!1,isOpenedModal:!1}),mounted(){},computed:{categoriesLeft(){return this.store.categories?.filter((e=>!this.categories.includes(e)))}},methods:{getFile(e){const t=this.$refs[e];if(!t)return;const o=t.$refs.input;return o?.files?.length?o.files[0]:void 0},openAdder(){this.isAdderOpen||(this.isAdderOpen=!0,K.Z.onFirstRandomClick((()=>{this.isAdderOpen=!1}),50))},addCategory(e){this.errors.categories="",this.categories.includes(e)||this.categories.push(e)},removeCategory(e){"object"==typeof e&&(e=e.id),this.categories=this.categories.filter((t=>t.id!=e))},hasError(){for(let e of Object.values(this.errors))if(e)return!0;return!1},clearFields(){for(let e of Object.keys(this.errors))this.errors[e]="",this.setInput(e,"")},async open(){this.isOpenedModal&&(this.isOpenedModal=!1,await this.$nextTick()),this.isOpenedModal=!0,this.categories=[],this.addCategory(this.firstCategory),await this.$nextTick(),H().fire({title:"Додати документи",html:this.modalHTML(),customClass:"show-overflow z0-buttons",showCancelButton:!0,confirmButtonText:"Додати",cancelButtonText:"Повернутися",preConfirm:()=>{const e=this.selectInput("name")?.value;if(e||(this.errors.name="Обовʼязкове поле"),this.categories?.length||(this.errors.categories="Немає категорій"),this.hasError())return!1;const t=this.categories.map((e=>e.id));return{name:e,categories:t}}}).then((async e=>{if(!e.isConfirmed)return;if(!e.value)return;const t=await v.Z.createForm(e.value);try{await v.Z.uploadFiles(t.id,this.getFile("blank"),this.getFile("sample")),K.Z.toast("Документ був успішно створен","success")}catch(o){console.error(o),K.Z.toast("Документ було створено, але з помилками","warning")}this.$emit("reloadDocuments")})).catch((e=>{console.error(e),H().fire("Помилка",K.Z.errorOf(e),"error")})).finally((()=>{this.isOpenedModal=!1}))}},emits:{reloadDocuments:()=>!0}});const G=(0,P.Z)(V,[["render",z],["__scopeId","data-v-1930165a"]]);var J=G;function Q(e,t,o,i,r,a){const n=(0,s.up)("ListMenu");return(0,s.wg)(),(0,s.j4)(s.lR,{to:"#page-view"},[(0,s.Wm)(n,{"is-open":!!e.options?.isOpen,class:"form-actions","marker-rotate":"-135deg",top:e.options?.y,right:e.options?.x,"marker-right":"20px","marker-top":"-5px"},{default:(0,s.w5)((()=>[(0,s._)("p",{onClick:t[0]||(t[0]=t=>e.$emit("view",e.options.form))},"Переглянути"),e.session.me?.admin?((0,s.wg)(),(0,s.iD)("p",{key:0,onClick:t[1]||(t[1]=t=>e.editForm(e.options.form))},"Редагувати")):(0,s.kq)("",!0),e.options?.form?.blankLink?((0,s.wg)(),(0,s.iD)("p",{key:1,onClick:t[2]||(t[2]=(...t)=>e.downloadBlank&&e.downloadBlank(...t))},"Завантажити бланк")):(0,s.kq)("",!0),e.options?.form?.sampleLink?((0,s.wg)(),(0,s.iD)("p",{key:2,onClick:t[3]||(t[3]=(...t)=>e.viewSample&&e.viewSample(...t))},"Переглянути зразок")):(0,s.kq)("",!0),e.session.me?.admin?((0,s.wg)(),(0,s.iD)("p",{key:3,class:"delete",onClick:t[4]||(t[4]=t=>e.deleteForm(e.options.form))},"Видалити")):(0,s.kq)("",!0)])),_:1},8,["is-open","top","right"])])}var X=(0,s.aZ)({name:"FormActions",components:{ListMenu:Y.Z},setup:()=>({session:(0,b.Z)()}),props:{options:Object},data:()=>({}),mounted(){},computed:{},methods:{downloadBlank(){this.options?.form?.blankLink&&v.Z.downloadBlank(this.options.form)},viewSample(){if(!this?.options?.form?.sampleLink)return;const e=this.options.form.sampleLink+"?fileName=_";K.Z.openPDF(e)},editForm(e){this.session.me?.admin&&this.$emit("edit",e)},deleteForm(e){this.session.me?.admin&&H().fire({icon:"question",title:"Ви впевнені?",text:"Ви впевнені що хочете видалити документ "+e.name,showConfirmButton:!1,showCancelButton:!0,showDenyButton:!0,focusCancel:!0,denyButtonText:"Видалити",cancelButtonText:"Ні"}).then((async t=>{t.isDenied&&(await v.Z.deleteForm(e),this.$emit("reload"),H().fire("Успіх","Документ "+e.name+"був видален","success"))})).catch((e=>{console.error(e),K.Z.swalError(e)}))}},emits:{view:e=>!0,edit:e=>!0,reload:()=>!0}});const ee=(0,P.Z)(X,[["render",Q],["__scopeId","data-v-5cfb7d48"]]);var te=ee;const oe=e=>((0,s.dD)("data-v-6b1bbf32"),e=e(),(0,s.Cn)(),e),se=oe((()=>(0,s._)("i",{class:"fa-light fa-ballot-check"},null,-1))),ie=oe((()=>(0,s._)("p",null,"Бланк",-1))),re=[se,ie],ae=oe((()=>(0,s._)("i",{class:"fa-light fa-address-book"},null,-1))),ne=oe((()=>(0,s._)("p",null,"Зразок",-1))),le=[ae,ne],ce={key:0,class:"input-block category-block"},de=oe((()=>(0,s._)("p",{class:"label"},"Категорії:",-1))),me={class:"categories"};function ue(e,t,o,r,a,n){const l=(0,s.up)("Modal");return e.form?((0,s.wg)(),(0,s.j4)(l,{key:0,props:e.$props,ref:"modal"},{default:(0,s.w5)((()=>[(0,s._)("p",null,(0,i.zw)(e.form.name),1),(0,s._)("div",{class:(0,i.C_)(["view-files",{bi:e.form.blankLink&&e.form.sampleLink}])},[e.form.blankLink?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"file",onClick:t[0]||(t[0]=(...t)=>e.downloadBlank&&e.downloadBlank(...t))},re)):(0,s.kq)("",!0),e.form.sampleLink?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"file",onClick:t[1]||(t[1]=(...t)=>e.viewSample&&e.viewSample(...t))},le)):(0,s.kq)("",!0)],2),e.categories?.length?((0,s.wg)(),(0,s.iD)("div",ce,[de,(0,s._)("div",me,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.categories,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"category",key:e.id},[(0,s._)("p",null,(0,i.zw)(e.name),1)])))),128))])])):(0,s.kq)("",!0)])),_:1},8,["props"])):(0,s.kq)("",!0)}var pe=(0,s.aZ)({name:"FormViewModal",components:{Modal:T.Z},mixins:[_.O],props:{...T.w},setup:()=>({store:(0,w.Z)()}),data:()=>({form:void 0,categories:[]}),mounted(){},computed:{},methods:{downloadBlank(){this.form?.blankLink&&v.Z.downloadBlank(this.form)},viewSample(){if(!this?.form?.sampleLink)return;const e=this.form.sampleLink+"?fileName=_";K.Z.openPDF(e)},async open(e){const t=await this.store.takeCategories();(this.form||this.categories?.length)&&(this.form=void 0,this.categories=[],await this.$nextTick()),this.form=e,v.Z.getCategoriesFrom(e).then((async o=>{this.form==e&&(this.categories=t.filter((e=>o.includes(e.id))),console.log("result:",this.categories.map((e=>e.name))))})),await this.$nextTick(),H().fire({title:"Документ",html:this.modalHTML(),customClass:"show-overflow",showCancelButton:!0,showConfirmButton:!1,cancelButtonText:"Повернутися"}).then((()=>{}))}},emits:{}});const fe=(0,P.Z)(pe,[["render",ue],["__scopeId","data-v-6b1bbf32"]]);var he=fe;const ge=e=>((0,s.dD)("data-v-6187ba36"),e=e(),(0,s.Cn)(),e),ke={class:"input-block"},we=ge((()=>(0,s._)("label",{for:"name"},"Назва:",-1))),ve={class:"error-label"},ye={key:0,class:"upload-files"},be={class:"input-block category-block"},_e=ge((()=>(0,s._)("p",{class:"label"},"Категорії:",-1))),Ce={class:"categories"},De=["onClick"],Fe=ge((()=>(0,s._)("i",{class:"fa-solid fa-plus"},null,-1))),Ze=[Fe],Le={key:1},Me=["onClick"],Ae={class:"error-label"};function xe(e,t,o,r,a,n){const l=(0,s.up)("FileUploader"),c=(0,s.up)("ListMenu"),d=(0,s.up)("Modal");return(0,s.wg)(),(0,s.j4)(d,{props:e.$props,ref:"modal"},{default:(0,s.w5)((()=>[(0,s._)("div",ke,[we,(0,s._)("input",{type:"text",name:"name",id:"name",onInput:t[0]||(t[0]=t=>e.errors.name="")},null,32)]),(0,s._)("p",ve,(0,i.zw)(e.errors.name),1),e.form?((0,s.wg)(),(0,s.iD)("div",ye,[(0,s.Wm)(l,{ref:"blank",icon:e.form?.blankLink&&"fa-ballot-check",label:e.form?.blankLink?"Замінити бланк":"Додати бланк"},null,8,["icon","label"]),(0,s.Wm)(l,{ref:"sample",icon:e.form?.sampleLink&&"fa-address-book",label:e.form?.sampleLink?"Замінити зразок":"Додати зразок"},null,8,["icon","label"])])):(0,s.kq)("",!0),(0,s._)("div",be,[_e,(0,s._)("div",Ce,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.categories,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"category",key:t.id},[(0,s._)("div",{class:"close",onClick:o=>e.removeCategory(t)},null,8,De),(0,s._)("p",null,(0,i.zw)(t.name),1)])))),128)),e.categoriesLeft?.length?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"add",onClick:t[1]||(t[1]=(...t)=>e.openAdder&&e.openAdder(...t))},Ze)):(0,s.kq)("",!0),e.categoriesLeft?.length?((0,s.wg)(),(0,s.iD)("div",Le,[(0,s.Wm)(c,{"is-open":e.isAdderOpen,"marker-top":"-5px","marker-left":"15px","marker-rotate":"-135deg",class:"category-adder"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.categoriesLeft,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id,onClick:o=>e.addCategory(t)},[(0,s._)("p",null,(0,i.zw)(t.name),1)],8,Me)))),128))])),_:1},8,["is-open"])])):(0,s.kq)("",!0)])]),(0,s._)("p",Ae,(0,i.zw)(e.errors.categories),1)])),_:1},8,["props"])}var Be=(0,s.aZ)({name:"EditFormModal",components:{Modal:T.Z,FileUploader:N,ListMenu:Y.Z},mixins:[_.O],props:{...T.w},setup:()=>({store:(0,w.Z)()}),data:()=>({errors:{name:"",categories:""},form:void 0,categories:[],isAdderOpen:!1}),mounted(){},computed:{categoriesLeft(){return this.store.categories?.filter((e=>!this.categories.includes(e)))}},methods:{getFile(e){const t=this.$refs[e];if(console.log("component",t),!t)return;const o=t.$refs.input;return console.log("input",o),o?.files?.length?o.files[0]:void 0},openAdder(){this.isAdderOpen||(this.isAdderOpen=!0,K.Z.onFirstRandomClick((()=>{this.isAdderOpen=!1}),50))},addCategory(e){this.errors.categories="",this.categories.includes(e)||this.categories.push(e)},removeCategory(e){"object"==typeof e&&(e=e.id),this.categories=this.categories.filter((t=>t.id!=e))},hasError(){for(let e of Object.values(this.errors))if(e)return!0;return!1},clearFields(){for(let e of Object.keys(this.errors))this.errors[e]="",this.setInput(e,"")},async open(e){const t=await this.store.takeCategories();(this.form||this.categories?.length)&&(this.form=void 0,this.categories=[],await this.$nextTick()),this.form=e,this.setInput("name",e.name),v.Z.getCategoriesFrom(e).then((async o=>{this.form==e&&(this.categories=t.filter((e=>o.includes(e.id))),console.log("result:",this.categories.map((e=>e.name))))})),await this.$nextTick(),H().fire({title:"Редагувати документ",html:this.modalHTML(),customClass:"show-overflow z0-buttons",showCancelButton:!0,confirmButtonText:"Зберегти",cancelButtonText:"Повернутися",preConfirm:()=>{const t=this.selectInput("name")?.value;if(t||(this.errors.name="Обовʼязкове поле"),this.categories?.length||(this.errors.categories="Немає категорій"),this.hasError())return!1;const o=this.categories.map((e=>e.id));return{id:e.id,name:t,categories:o}}}).then((async e=>{if(e.isConfirmed&&e.value){await v.Z.editForm(e.value);try{await v.Z.uploadFiles(e.value.id,this.getFile("blank"),this.getFile("sample")),K.Z.toast("Документ був успішно збережен","success")}catch(t){console.error(t),K.Z.toast("Документ було збережен, але з помилками","warning")}this.$emit("reloadDocuments")}})).catch((e=>{console.error(e),H().fire("Помилка",K.Z.errorOf(e),"error")})).finally((()=>{}))}},emits:{reloadDocuments:()=>!0}});const Oe=(0,P.Z)(Be,[["render",xe],["__scopeId","data-v-6187ba36"]]);var qe=Oe,$e=o(3513),Se=(0,s.aZ)({name:"DocumentsPage",components:{PageHead:y.Z,CreateFormModal:J,FormActions:te,FormViewModal:he,EditFormModal:qe},mixins:[_.V],setup:()=>({store:(0,w.Z)(),session:(0,b.Z)()}),data:()=>({documentForms:void 0,formActions:void 0,filter:""}),computed:{filteredForms(){if(!this.filter)return this.documentForms;const e=this.filter.toLowerCase().trim();return this.documentForms?.filter((t=>t.name.toLowerCase().includes(e)))},categoryName(){return decodeURIComponent(this.$route.path.substring(11))},category(){const e=this.categoryName;return this.store.categories?.find((t=>t.name==e))}},mounted(){this.category&&this.loadDocumentsForm(this.category)},methods:{loadDocumentsForm(e){this.documentForms=void 0,v.Z.getAllDocumentForm(e.id).then((t=>{this.category?.id==e.id&&(this.documentForms=t)})).catch((e=>{console.error("form error",e)}))},async openFormActions(e,t){if(this.formActions?.isOpen){if(this.formActions.form==e)return;this.formActions.isOpen=!1,await $e.Z.sleep(50)}const o=K.Z.findParentElement(t.target,"more");if(!o)return;const s=o.getBoundingClientRect();let i=0,r=o;while(r)i+=r.scrollTop,r=r.parentElement;this.formActions={isOpen:!0,form:e,x:window.innerWidth-s.right-14,y:s.top+i+40},K.Z.onFirstRandomClick((()=>{this.formActions?.form==e&&(this.formActions.isOpen=!1)}),100)}},watch:{category(e,t){this.documentForms=void 0,e&&this.loadDocumentsForm(e)}},emits:{}});const Ie=(0,P.Z)(Se,[["render",k],["__scopeId","data-v-59691208"]]);var ze=Ie},1969:function(e,t,o){o.d(t,{Z:function(){return d}});var s=o(3396),i=o(7139);const r={class:"values"};function a(e,t,o,a,n,l){return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["list-menu",{opened:e.isOpen}]),style:(0,i.j5)(e.style)},[(0,s._)("div",r,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])],6)}var n=(0,s.aZ)({name:"ListMenu",props:{isOpen:Boolean,markerTop:String,markerLeft:String,markerRight:String,markerBottom:String,markerSize:String,markerRotate:String,noAnimation:Boolean,top:Number,left:Number,right:Number},computed:{style(){let e="";return this.markerTop&&(e+="--m-top: "+this.markerTop+";"),this.markerLeft&&(e+="--m-left: "+this.markerLeft+";"),this.markerRight&&(e+="--m-right: "+this.markerRight+";"),this.markerBottom&&(e+="--m-bottom: "+this.markerBottom+";"),e+=e?"--m-display: block;":"--m-display: none;",e+="--m-size: "+(this.markerSize||"10px")+";",e+="--m-rotate: "+(this.markerRotate||"45deg")+";",this.noAnimation&&(e+="animation: none;"),this.top&&(e+="top: "+this.top+"px;"),this.left&&(e+="left: "+this.left+"px;"),this.right&&(e+="right: "+this.right+"px;"),e}}}),l=o(89);const c=(0,l.Z)(n,[["render",a],["__scopeId","data-v-5b654970"]]);var d=c},7106:function(e,t,o){o.d(t,{Z:function(){return p}});var s=o(3396);const i=e=>((0,s.dD)("data-v-43d92d95"),e=e(),(0,s.Cn)(),e),r={class:"search-bar"},a=i((()=>(0,s._)("i",{class:"fa-solid fa-magnifying-glass"},null,-1))),n=i((()=>(0,s._)("p",null,"+",-1))),l=[n];function c(e,t,o,i,n,c){return(0,s.wg)(),(0,s.iD)("div",r,[a,(0,s._)("input",{type:"text",placeholder:"Пошук",onInput:t[0]||(t[0]=t=>e.$emit("input",t))},null,32),e.create?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"create",onClick:t[1]||(t[1]=t=>e.$emit("create",t))},l)):(0,s.kq)("",!0)])}var d=(0,s.aZ)({name:"MinSearchBar",props:{create:Boolean},emits:{input:e=>!0,create:e=>!0}}),m=o(89);const u=(0,m.Z)(d,[["render",c],["__scopeId","data-v-43d92d95"]]);var p=u}}]);